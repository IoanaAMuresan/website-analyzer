<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Improvement Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #FF6B6B 0%, #FFD93D 100%);
            padding: 40px;
            text-align: center;
            color: white;
            position: relative;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .kirin-logo {
            width: 80px;
            height: 80px;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDUwMCA1MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0yNTAgNTBMMzAwIDEwMEwyNTAgMTUwTDIwMCAxMDBMMjUwIDUwWiIgc3Ryb2tlPSIjRkY2QjZCIiBzdHJva2Utd2lkdGg9IjgiIGZpbGw9Im5vbmUiLz4KPGF1Y2lyY2xlIGN4PSIxNzAiIGN5PSIyMDAiIHI9IjMwIiBzdHJva2U9IiNGRjZCNkIiIHN0cm9rZS13aWR0aD0iOCIgZmlsbD0ibm9uZSIvPgo8Y2lyY2xlIGN4PSIxNzAiIGN5PSIyMDAiIHI9IjE1IiBzdHJva2U9IiNGRjZCNkIiIHN0cm9rZS13aWR0aD0iNCIgZmlsbD0ibm9uZSIvPgo8Y2lyY2xlIGN4PSIzMzAiIGN5PSIyMDAiIHI9IjMwIiBzdHJva2U9IiNGRjZCNkIiIHN0cm9rZS13aWR0aD0iOCIgZmlsbD0ibm9uZSIvPgo8Y2lyY2xlIGN4PSIzMzAiIGN5PSIyMDAiIHI9IjE1IiBzdHJva2U9IiNGRjZCNkIiIHN0cm9rZS13aWR0aD0iNCIgZmlsbD0ibm9uZSIvPgo8cGF0aCBkPSJNMTAwIDEwMEM5MCAyNTAgNDEwIDI1MCA0MDAgMTAwIiBzdHJva2U9IiNGRkQ5M0QiIHN0cm9rZS13aWR0aD0iMTAiIGZpbGw9Im5vbmUiLz4KPHN2ZyBjbGFzcz0ibG9nby1pbWFnZSI+CjxyZWN0IHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiBmaWxsPSJ0cmFuc3BhcmVudCIvPgo8L3N2Zz4KPC9zdmc+') center/contain no-repeat;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .input-section {
            padding: 40px;
            background: #f8fafc;
        }

        .url-input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .url-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .url-input:focus {
            outline: none;
            border-color: #FF6B6B;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .analyze-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #FF6B6B 0%, #FFD93D 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }

        .analyze-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
            display: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid #FF6B6B;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            padding: 40px;
            display: none;
        }

        .results.show {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .results-header h2 {
            font-size: 2rem;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .analyzed-url {
            color: #64748b;
            font-size: 1.1rem;
            word-break: break-all;
        }

        .improvement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
        }

        .improvement-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 5px solid #4facfe;
            transition: transform 0.3s ease;
        }

        .improvement-card:hover {
            transform: translateY(-5px);
        }

        .improvement-card h3 {
            color: #1e293b;
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .improvement-card .icon {
            font-size: 1.5rem;
        }

        .improvement-list {
            list-style: none;
        }

        .improvement-list li {
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
            color: #475569;
        }

        .improvement-list li:last-child {
            border-bottom: none;
        }

        .improvement-list li::before {
            content: "‚Üí";
            color: #4facfe;
            font-weight: bold;
            margin-right: 10px;
        }

        .recommendation-text {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .recommendation-source {
            font-size: 0.85rem;
            color: #64748b;
            font-style: italic;
        }

        .priority-high { border-left-color: #ef4444; }
        .priority-medium { border-left-color: #f59e0b; }
        .priority-low { border-left-color: #10b981; }

        .priority-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-left: auto;
        }

        .priority-high .priority-badge {
            background: #fee2e2;
            color: #dc2626;
        }

        .priority-medium .priority-badge {
            background: #fef3c7;
            color: #d97706;
        }

        .priority-low .priority-badge {
            background: #d1fae5;
            color: #059669;
        }

        .export-section {
            margin-top: 40px;
            text-align: center;
            padding: 30px;
            background: #f8fafc;
            border-radius: 15px;
        }

        .export-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #FF6B6B 0%, #FFD93D 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }


    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <div class="kirin-logo"></div>
                <div>
                    <h1>üîç Website Improvement Analyzer</h1>
                    <p style="font-size: 1rem; margin-top: 5px; opacity: 0.9;">TEAM KIRIN ‚Ä¢ WORDPRESS.COM HAPPINESS</p>
                </div>
            </div>
            <p>Analyze any website and discover actionable improvements for your customers</p>
        </div>

        <div class="input-section">
            <div class="url-input-group">
                <input type="url" class="url-input" placeholder="Enter website URL (e.g., https://example.com)" id="urlInput">
                <button class="analyze-btn" onclick="analyzeWebsite()">Analyze Site</button>
            </div>

            <p style="color: #64748b; font-size: 0.9rem; margin-top: 10px;">
                üí° This tool analyzes website elements and provides WordPress.com-focused improvement suggestions
            </p>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing website... This may take a moment.</p>
        </div>

        <div class="results" id="results">
            <div class="results-header">
                <h2>Analysis Results</h2>
                <div class="analyzed-url" id="analyzedUrl"></div>
            </div>

            <div class="improvement-grid" id="improvementGrid">
                <!-- Results will be populated here -->
            </div>

            <div class="export-section">
                <button class="export-btn" onclick="exportResults()">üìã Export Report</button>
                <p style="color: #64748b; font-size: 0.9rem; margin-top: 10px;">
                    Export as text to share with your customer
                </p>
            </div>
        </div>
    </div>

    <script>
        let analysisResults = {};

        async function analyzeWebsite() {
            const urlInput = document.getElementById('urlInput');
            const url = urlInput.value.trim();
            
            if (!url) {
                alert('Please enter a website URL');
                return;
            }

            let targetUrl = url;
            if (!targetUrl.startsWith('http://') && !targetUrl.startsWith('https://')) {
                targetUrl = 'https://' + targetUrl;
                urlInput.value = targetUrl;
            }

            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').classList.remove('show');
            document.querySelector('.analyze-btn').disabled = true;

            try {
                await performRealAnalysis(targetUrl);
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('results').classList.add('show');
                document.getElementById('analyzedUrl').textContent = targetUrl;
                
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                showError('Analysis completed with limited data. Some checks may require direct site access.');
                // Still show results even if there were errors
                document.getElementById('results').classList.add('show');
                document.getElementById('analyzedUrl').textContent = targetUrl;
            } finally {
                document.querySelector('.analyze-btn').disabled = false;
            }
        }

        async function performRealAnalysis(url) {
            try {
                // Call the real backend API
                const response = await fetch('https://website-analyzer-4f8s.vercel.app/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ url: url })
                });

                if (!response.ok) {
                    throw new Error(`Analysis failed: ${response.status}`);
                }

                const data = await response.json();
                
                // Store the real results
                analysisResults = data;
                
                displayResults();
                
            } catch (error) {
                console.error('Analysis error:', error);
                
                // Fallback to basic analysis if API fails
                showError('Unable to connect to analysis server. Showing basic recommendations.');
                
                // Provide basic fallback analysis
                const fallbackResults = {
                    url: url,
                    improvements: [
                        {
                            category: 'Connection Issue',
                            icon: '‚ö†Ô∏è',
                            priority: 'high',
                            items: [
                                { text: 'Unable to analyze site - check if URL is correct and accessible', source: 'Connection error' },
                                { text: 'Consider WordPress.com hosting for reliable uptime', source: 'WordPress.com benefits' }
                            ]
                        }
                    ]
                };
                
                analysisResults = fallbackResults;
                displayResults();
            }
        }

        function displayResults() {
            const grid = document.getElementById('improvementGrid');
            grid.innerHTML = '';

            analysisResults.improvements.forEach(category => {
                const card = document.createElement('div');
                card.className = `improvement-card priority-${category.priority}`;
                
                const priorityText = category.priority.charAt(0).toUpperCase() + category.priority.slice(1);
                
                const itemsHtml = category.items.map(item => {
                    if (typeof item === 'object') {
                        return `<li>
                            <div class="recommendation-text">${item.text}</div>
                            <div class="recommendation-source">Source: ${item.source}</div>
                        </li>`;
                    } else {
                        return `<li><div class="recommendation-text">${item}</div></li>`;
                    }
                }).join('');
                
                card.innerHTML = `
                    <h3>
                        <span class="icon">${category.icon}</span>
                        ${category.category}
                        <span class="priority-badge">${priorityText}</span>
                    </h3>
                    <ul class="improvement-list">
                        ${itemsHtml}
                    </ul>
                `;
                
                grid.appendChild(card);
            });
        }

        function exportResults() {
            let report = `WordPress.com Website Analysis Report\n${'='.repeat(40)}\n\n`;
            report += `URL: ${analysisResults.url}\n`;
            report += `Analysis Date: ${new Date().toLocaleDateString()}\n`;
            report += `Analyzed by: WordPress.com Team Kirin\n\n`;

            report += `EXECUTIVE SUMMARY\n${'-'.repeat(20)}\n`;
            report += `This analysis provides actionable recommendations to improve your website's\n`;
            report += `performance, SEO, user experience, and WordPress.com optimization.\n\n`;

            analysisResults.improvements.forEach(category => {
                report += `${category.category.toUpperCase()} (${category.priority.toUpperCase()} PRIORITY)\n`;
                report += `${'-'.repeat(category.category.length + 20)}\n`;
                category.items.forEach((item, index) => {
                    const text = typeof item === 'object' ? item.text : item;
                    const source = typeof item === 'object' ? item.source : '';
                    report += `${index + 1}. ${text}\n`;
                    if (source) report += `   Source: ${source}\n`;
                });
                report += '\n';
            });

            report += `NEXT STEPS\n${'-'.repeat(15)}\n`;
            report += `1. Start with HIGH priority items for immediate impact\n`;
            report += `2. WordPress.com customers can implement these through their admin panel\n`;
            report += `3. Contact WordPress.com support for technical assistance\n`;
            report += `4. Re-analyze after changes to track improvements\n\n`;

            report += `Generated by WordPress.com Website Improvement Analyzer\n`;
            report += `Team Kirin - WordPress.com Happiness Team\n`;

            // Copy to clipboard
            navigator.clipboard.writeText(report).then(() => {
                alert('Report copied to clipboard! You can now paste it into an email or document to share with your customer.');
            }).catch(() => {
                // Fallback: create a downloadable text file
                const blob = new Blob([report], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a
